## 成熟产品的技术支持

上一篇简单描述了一个产品的基础设施，这里再记录支持一个产品的技术链条，服务最重要稳定，有容错机制，

1. 开发
   1. 单服务，敏捷开发
   2. 微服务，分拆服务
   3. 流量并发控制
   4. 分布式存储
   5. CI
2. 部署 （[参考][部署参考]）
   1. 蓝绿部署
      1. 目的是减少发布过程中服务停止的时间。只适用于只有一台服务器的情况。
      2. 运行中的系统为绿色，需要进行新部署时，重新部署一套系统，新系统为蓝色。可以在新系统中做任意测试和修改，等到稳定后，通过把反向代理指向蓝色新系统，观察一段时间，如果新系统出现问题，直接切回旧系统，如果没有问题，把旧系统关闭。
   2. 金丝雀发布（Canary，也叫灰度发布）
      1. 主要是应用于分布式系统，假设有 100 台服务器，先将其中 10 台换成最新的，观察，如果没有问题，再逐步替换剩下的。
      2. 实际操作中还可以做更多控制，譬如说，给最初更新的10台服务器设置较低的权重、控制发送给这10台服务器的请求数，然后逐渐提高权重、增加请求数。这个控制叫做“流量切分”
   3. 分布式部署
   4. 服务自动注册与发现，负载均衡
      1. Zookeeper
      2. Eureka
      3. Consul
      4. Etcd
   5. 数据库安全
   6. 限流
3. 运维
   1. 系统监控
      1. 服务监控
      2. 域名监控
      3. 数据库监控
4. 测试
   1. A/B 测试
      1. A/B测试是效果测试，同一时间有多个版本的服务对外服务，这些服务都是经过足够测试，达到了上线标准的服务，有差异但是没有新旧之分（它们上线时可能采用了蓝绿部署的方式）。


[微服务架构]: https://www.zhihu.com/question/65502802
[部署参考]: https://www.lijiaocn.com/%E6%96%B9%E6%B3%95/2018/10/23/devops-blue-green-deployment-ab-test-canary.html
